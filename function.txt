This is function version 1.